# ============================================================================
# NEWS SUMMARIZER API - ENVIRONMENT CONFIGURATION
# ============================================================================
# Copy this file to .env and fill in your actual values
# NEVER commit .env to version control!
# ============================================================================

# ============================================================================
# APPLICATION SETTINGS
# ============================================================================
APP_NAME=News Summarizer API
APP_VERSION=1.0.0
ENVIRONMENT=development
# Options: development, staging, production
DEBUG=False

# Server Configuration
HOST=0.0.0.0
PORT=8000
API_V1_PREFIX=/api/v1
FRONTEND_URL=http://localhost:8501

# ============================================================================
# DATABASE CONFIGURATION
# ============================================================================
# PostgreSQL Connection String (AsyncPG format for async operations)
DATABASE_URL=postgresql+asyncpg://postgres:password@localhost:5432/news_summarizer

# Test Database (for running tests)
TEST_DATABASE_URL=postgresql+asyncpg://postgres:password@localhost:5432/news_summarizer_test

# ============================================================================
# REDIS CONFIGURATION
# ============================================================================
# Redis Connection String (for caching and rate limiting)
REDIS_URL=redis://localhost:6379/0
REDIS_MAX_CONNECTIONS=50
REDIS_CACHE_TTL=900
# Cache TTL in seconds (default: 15 minutes)

# ============================================================================
# SECURITY & AUTHENTICATION
# ============================================================================
# Secret Key (MUST be at least 32 characters, generate with: python -c "import secrets; print(secrets.token_urlsafe(32))")
SECRET_KEY=your-super-secret-key-change-this-in-production-min-32-chars

# JWT Configuration (RS256 Algorithm with Public/Private Keys)
JWT_ALGORITHM=RS256
JWT_PRIVATE_KEY_PATH=./keys/private_key.pem
JWT_PUBLIC_KEY_PATH=./keys/public_key.pem
# Optional: Provide keys directly as environment variables (overrides file paths)
JWT_PRIVATE_KEY=
JWT_PUBLIC_KEY=

# Token Expiration
ACCESS_TOKEN_EXPIRE_HOURS=15
REFRESH_TOKEN_EXPIRE_DAYS=7

# Bcrypt/Argon2 Configuration
BCRYPT_ROUNDS=12
ARGON2_TIME_COST=2
ARGON2_MEMORY_COST=65536
# 64 MB
ARGON2_PARALLELISM=4
ARGON2_HASH_LENGTH=32
ARGON2_SALT_LENGTH=16

# ============================================================================
# PASSWORD POLICY
# ============================================================================
PASSWORD_MIN_LENGTH=8
PASSWORD_REQUIRE_UPPERCASE=True
PASSWORD_REQUIRE_LOWERCASE=True
PASSWORD_REQUIRE_DIGIT=True
PASSWORD_REQUIRE_SPECIAL=True

# ============================================================================
# ACCOUNT SECURITY
# ============================================================================
MAX_LOGIN_ATTEMPTS=5
ACCOUNT_LOCKOUT_DURATION_MINUTES=30
FAILED_LOGIN_RESET_HOURS=24

# Email Verification
EMAIL_VERIFICATION_REQUIRED=False
EMAIL_VERIFICATION_TOKEN_EXPIRE_HOURS=24
PASSWORD_RESET_TOKEN_EXPIRE_HOURS=1

# Session Management
MAX_ACTIVE_SESSIONS=5
SESSION_CLEANUP_INTERVAL_HOURS=1

# ============================================================================
# CORS CONFIGURATION
# ============================================================================
# Comma-separated list of allowed origins
CORS_ORIGINS=http://localhost:3000,http://localhost:8080
CORS_ALLOW_CREDENTIALS=True
CORS_ALLOW_METHODS=*
CORS_ALLOW_HEADERS=*
CORS_MAX_AGE=600

# ============================================================================
# SECURITY HEADERS
# ============================================================================
ENABLE_HSTS=True
HSTS_MAX_AGE=31536000
# 1 year in seconds
ENABLE_CSP=True
CSP_POLICY=default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' data:;

# Cookie Settings
COOKIE_SECURE=True
# Set to False in development with HTTP
COOKIE_HTTPONLY=True
COOKIE_SAMESITE=lax

# API Security
API_KEY_HEADER=X-API-Key

# ============================================================================
# RATE LIMITING
# ============================================================================
RATE_LIMIT_ENABLED=True
RATE_LIMIT_PER_MINUTE=100
RATE_LIMIT_BURST=20
RATE_LIMIT_BACKOFF_BASE=2.0
RATE_LIMIT_MAX_VIOLATIONS=5
RATE_LIMIT_BAN_DURATION_MINUTES=60

# Auth-specific rate limits
AUTH_RATE_LIMIT_PER_MINUTE=10
AUTH_RATE_LIMIT_PER_HOUR=100

# ============================================================================
# REQUEST VALIDATION
# ============================================================================
MAX_REQUEST_SIZE_MB=1
ALLOWED_CONTENT_TYPES=application/json,application/x-www-form-urlencoded,multipart/form-data

# ============================================================================
# EMAIL CONFIGURATION (SMTP)
# ============================================================================
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASSWORD=your-app-specific-password
SMTP_FROM_EMAIL=noreply@newssummarizer.com
SMTP_FROM_NAME=News Summarizer

# ============================================================================
# NEWS AGGREGATION SERVICES
# ============================================================================
# NewsAPI Configuration (https://newsapi.org/)
NEWSAPI_KEY=your-newsapi-key-here
NEWSAPI_BASE_URL=https://newsapi.org/v2
NEWSAPI_TIMEOUT=5
NEWSAPI_MAX_RETRIES=3

# GDELT Configuration (no API key required)
GDELT_BASE_URL=https://api.gdeltproject.org/api/v2/doc/doc
GDELT_TIMEOUT=5

# News Aggregation Settings
NEWS_CACHE_TTL=900
# 15 minutes in seconds
NEWS_DEDUPLICATION_THRESHOLD=0.8
# 80% similarity threshold
NEWS_CIRCUIT_BREAKER_THRESHOLD=5
NEWS_CIRCUIT_BREAKER_TIMEOUT=60
NEWS_MAX_ARTICLES_PER_SOURCE=50

# ============================================================================
# LLM INTEGRATION (Large Language Models)
# ============================================================================
# OpenAI Configuration
OPENAI_API_KEY=sk-your-openai-api-key-here
OPENAI_MODEL=gpt-4-turbo-preview
# Options: gpt-4-turbo-preview, gpt-4, gpt-3.5-turbo
OPENAI_MAX_TOKENS=500
OPENAI_TEMPERATURE=0.3

# Anthropic (Claude) Configuration
ANTHROPIC_API_KEY=sk-ant-your-anthropic-api-key-here
ANTHROPIC_MODEL=claude-3-sonnet-20240229
# Options: claude-3-opus-20240229, claude-3-sonnet-20240229, claude-3-haiku-20240307

# Local LLM Configuration (Ollama/LM Studio)
LOCAL_LLM_URL=http://localhost:11434

# Default LLM Provider
LLM_PROVIDER=openai
# Options: openai, anthropic, local

# ============================================================================
# LOGGING CONFIGURATION
# ============================================================================
LOG_LEVEL=INFO
# Options: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_FILE=logs/app.log
LOG_MAX_SIZE_MB=10
LOG_BACKUP_COUNT=5
LOG_REQUESTS=True

# ============================================================================
# FILE UPLOAD CONFIGURATION
# ============================================================================
UPLOAD_DIR=uploads
MAX_UPLOAD_SIZE_MB=10
ALLOWED_EXTENSIONS=jpg,jpeg,png,gif,pdf,txt,csv

# ============================================================================
# PRODUCTION DEPLOYMENT NOTES
# ============================================================================
# 1. Generate a strong SECRET_KEY:
#    python -c "import secrets; print(secrets.token_urlsafe(32))"
#
# 2. Generate RSA key pair for JWT:
#    python generate_keys.py
#
# 3. Set ENVIRONMENT=production
#
# 4. Set DEBUG=False
#
# 5. Set COOKIE_SECURE=True (requires HTTPS)
#
# 6. Use strong database credentials (not default passwords)
#
# 7. Configure proper CORS_ORIGINS for your frontend
#
# 8. Set up SMTP with actual email service credentials
#
# 9. Get actual API keys:
#    - NewsAPI: https://newsapi.org/
#    - OpenAI: https://platform.openai.com/api-keys
#    - Anthropic: https://console.anthropic.com/
#
# 10. Never commit .env to version control!
#     Add .env to .gitignore
# ============================================================================

